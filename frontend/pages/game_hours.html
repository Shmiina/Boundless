<div id="game-data-container">
    <h2>Loading Game Playtime Data...</h2>
</div>

<script>
    // 1. Define the URL of your deployed Google Apps Script Web App
    const WEB_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx0RGffOaH_8DgwrwektyUcyEptPt_cGhKWt7OeTKMhvJINeRqYNtBJXeUaB_BRZrXj/exec'; 

    // 2. This function is called by the Google Apps Script once the data is ready.
    //    The name of this function (e.g., handleGameTime) is passed via the URL.
    function handleGameTime(data) {
        const container = document.getElementById('game-data-container');
        let htmlContent = '<h1>ðŸŽ® Aggregated Game Time Report</h1>';
        
        if (data.length === 0) {
            htmlContent += '<p>No valid game data found in the spreadsheet.</p>';
        } else {
            htmlContent += `
                <table>
                    <thead>
                        <tr>
                            <th>Game Title</th>
                            <th style="text-align: right;">Total Hours Rendered</th>
                        </tr>
                    </thead>
                    <tbody>`;
            
            data.forEach(game => {
                htmlContent += `
                    <tr>
                        <td>${game.gameTitle}</td>
                        <td class="hours">${game.totalHours}</td>
                    </tr>`;
            });

            htmlContent += `</tbody></table>`;
        }

        container.innerHTML = htmlContent;
    }

    // 3. Function to dynamically create a script tag to load the data (JSONP)
    function loadGameDataJSONP() {
        const script = document.createElement('script');
        
        // Append the '?callback=handleGameTime' to the URL
        // This tells the Apps Script which function to wrap the JSON in.
        script.src = WEB_SCRIPT_URL + '?callback=handleGameTime'; 
        
        // This execution loads the script and runs the handleGameTime function
        document.head.appendChild(script);
        
        // Optional: Clean up the script tag after it runs (for memory)
        script.onload = function() {
            this.remove();
        };
        script.onerror = function() {
            document.getElementById('game-data-container').innerHTML = 
                '<p style="color: red;">Failed to load data using JSONP. Check the Web App URL.</p>';
        }
    }

    // 4. Call the JSONP function when the page loads
    window.onload = loadGameDataJSONP;
</script>

<style>
    /* ... (Your CSS styles) ... */
</style>