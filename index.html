<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Player Hours App</title>
<style>
:root {
    --bg: #f5f7fa;
    --card: #ffffff;
    --text: #111;
    --accent: #1a73e8;
    --accent-hover: #1558b8;
    --danger: #d93025;
}
[data-theme="dark"] {
    --bg: #0d1117;
    --card: #161b22;
    --text: #e6edf3;
    --accent: #58a6ff;
    --accent-hover: #1f6feb;
}
body {
    background: var(--bg);
    color: var(--text);
    margin: 0;
    font-family: "Inter", sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    padding: 20px;
}
.app-card {
    width: 100%;
    max-width: 450px;
    background: var(--card);
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 0 25px rgba(0,0,0,0.15);
}
.nav-main {
    display: flex;
    justify-content: space-between;
    margin-bottom: 20px;
}
.nav-main button {
    flex: 1;
    margin: 0 5px;
    padding: 12px;
    border: none;
    border-radius: 12px;
    background: var(--accent);
    color: #fff;
    font-weight: bold;
    cursor: pointer;
}
.nav-main button.active {
    background: var(--accent-hover);
}
.tab { display: none; }
.tab.show { display: block; }
.input-box {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    border: 2px solid #ccc;
    margin-bottom: 10px;
}
.app-btn {
    width: 100%;
    padding: 14px;
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 12px;
    font-weight: bold;
    cursor: pointer;
}
.player {
    display: flex;
    justify-content: space-between;
    padding: 12px;
    background: var(--card);
    border-radius: 12px;
    margin-bottom: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.12);
}
.list-box {
    max-height: 500px;
    overflow-y: auto;
}
</style>
</head>
<body data-theme="dark">
<div class="app-card">

    <div class="nav-main">
        <button id="tabLookup" class="active" onclick="showTab('lookup')">Lookup</button>
        <button id="tabLeaderboard" onclick="showTab('leaderboard')">Leaderboard</button>
        <button id="tabTwenty" onclick="showTab('twentyPlus')">20+ Hours</button>
    </div>

    <!-- PLAYER LOOKUP -->
    <div id="lookup" class="tab show">
        <h2>Player Lookup</h2>
        <input type="text" id="playerID" class="input-box" placeholder="Enter Player ID...">
        <button class="app-btn" onclick="lookupPlayer()">Search</button>
        <div id="lookupResult" style="margin-top:15px; font-size:18px;"></div>
    </div>

    <!-- LEADERBOARDS (TOP 10 PER CHARACTER) -->
    <div id="leaderboard" class="tab">
        <h2>Leaderboards</h2>
        <div style="display:flex; gap:10px; margin-bottom:10px;">
            <button class="app-btn" onclick="loadLeader('Nami')">Nami</button>
            <button class="app-btn" onclick="loadLeader('Pia')">Pia</button>
            <button class="app-btn" onclick="loadLeader('Freddie')">Freddie</button>
        </div>
        <div id="leaderList" class="list-box"></div>
    </div>

    <!-- 20+ HOURS TAB -->
    <div id="twentyPlus" class="tab">
        <h2>20+ Hours Players</h2>
        <div id="twentyList" class="list-box"></div>
    </div>

</div>

<script>
const apiUrl = "https://script.google.com/macros/s/AKfycbwOtTP8TgoM6URjfUNLqK0962-wRAP4IDHlKQApNvpov6dH7A7fxmrKSZ45hg_mKGBIaA/exec"; // Replace

function showTab(tab) {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('show'));
    document.getElementById(tab).classList.add('show');
    document.querySelectorAll('.nav-main button').forEach(b => b.classList.remove('active'));
    if (tab === 'lookup') tabLookup.classList.add('active');
    if (tab === 'leaderboard') tabLeaderboard.classList.add('active');
    if (tab === 'twentyPlus') tabTwenty.classList.add('active');
}

async function lookupPlayer() {
    const id = document.getElementById('playerID').value.trim();
    if (!id) return;

    const res = await fetch(`${apiUrl}?id=${id}`);
    const text = await res.text();

    document.getElementById('lookupResult').textContent = text;
}

async function loadLeader(char) {
    const res = await fetch(`${apiUrl}?leaderboard=${char}`);
    const data = await res.json();

    const top10 = data.slice(0, 10);
    const div = document.getElementById('leaderList');
    div.innerHTML = "";

    top10.forEach((p, i) => {
        div.innerHTML += `<div class="player"><span>#${i+1}</span><span>${p.id}</span><span>${parseFloat(p.hours).toFixed(2)}h</span></div>`;
    });
}

async function loadTwentyPlus() {
    const res = await fetch(`${apiUrl}?all=1`);
    const data = await res.json();

    const filtered = data.filter(p => parseFloat(p.hours) >= 20)
        .sort((a,b) => b.hours - a.hours);

    const div = document.getElementById('twentyList');
    div.innerHTML = "";

    filtered.forEach((p,i) => {
        div.innerHTML += `<div class="player"><span>#${i+1}</span><span>${p.id}</span><span>${parseFloat(p.hours).toFixed(2)}h</span></div>`;
    });
}

loadTwentyPlus();
</script>
</body>
</html>
